\documentclass[]{article}
\usepackage[margin=0.9in]{geometry}

\usepackage{enumitem}
\usepackage{graphicx}
\usepackage{float}
\usepackage{hyperref}
\usepackage[dvipsnames]{xcolor}

\newcommand{\docks}{\textbf{\textcolor{Cyan}{Docks}} }
\newcommand{\docker}{\textbf{\textcolor{OliveGreen}{Docker}} }

\graphicspath{{images/user-manual/}{images/logo/}{images/uml/}}

%opening
\title{\vspace{-1.0cm}Requirements and Design for Docks}
\author{\textbf{Team}: TripleParity\\
\textbf{Client}: Compiax\\
\\
\textbf{Team Members}\\
Francois Mentz\\
Connor Armand du Plooy\\
Raymond De Vos\\
Evert Geldenhuys\\
Anna-Mari√© Helberg\\
Paul Wood}

\date{}

\begin{document}
\begin{figure}[]
	\includegraphics[scale=0.7]{docks_round_512.png}
	\centering
\end{figure}

\maketitle

\tableofcontents

\pagebreak

\section{System Overview}
\subsection{Purpose}

% Why would I want to use Docks? 
\docker is a tool designed to make it easier to create, deploy and run applications
using lightweight virtualization. It provides a command line interface (CLI)
and RESTful API. Maintaining and deploying applications often involve multiple
people. Providing multiple people access to the \docker CLI requires
Secure Shell access (SSH) as root to the server running \docker. If the server
is secure it will only provide SSH access using public/private keys, which
reduces convenience and restricts access to devices that are SSH capable and
holds a private key. The \docker API lacks functions which are provided by
the CLI, so it cannot be used on its own.

The purpose of \docks is to provide a secure web user interface
for using \docker.

\subsection{Product Scope}

% Cool, you showed the limitations of Docker, now what can Docks do for me?
\docks will provide functionality in three areas
\begin{enumerate}
	\item Provide a secure* web user interface that enables using the
	      essential* functions exposed by the \docker API and CLI.
	\item Provide a secure API to allow third party services to integrate
	      with \docks and use \docker
	\item Send real time notifications to system administrators via Slack about
	      important events
\end{enumerate}

\subsection{Definitions, acronyms and abbreviations}

% TODO(egeldenhuys): More definitions
\begin{table}[H]
	\begin{tabular}{|p{2cm}|p{10cm}|}
		\hline
		\docks &  A system to provide a web user interface and API for using \docker \\ \hline

		\docker & Tool designed to make it easier to create, deploy and run applications
		using lightweight virtualization \\ \hline

		Image & ``A container is launched by running an image.
		An image is an executable package that includes everything
		needed to run an application--the code, a runtime, libraries,
		environment variables, and configuration files.'' \\ \hline

		Container & ``A container is a runtime instance 
		of an image--what the image becomes in memory when 
		executed (that is, an image with state, or a user process)'' \\ \hline

	\end{tabular}
\end{table}

\subsection{UML Domain Model}

\begin{figure}[H]
	\centering
	\includegraphics[scale=0.5]{domain-diagram.png}
	\caption{UML Domain Diagram for the Docks System}
\end{figure}

\section{Functional Requirements}

\subsection{Users}
\docks will appeal mainly to software developers and system administrators
with fundamental understanding of \docker. \docks will allow
them to deploy new applications with \docker as well as manage existing 
applications. With the web user interface they will be able to
update and troubleshoot applications using any web browser. They will
also be able to give access to the web user interface to other administrators
for assisting in management. It is assumed this category of users will
have knowledge on configuring applications to be deployed with \docker
and the ability to troubleshoot networks and applications.

\docks will also appeal to users that are interested in learning how
to use \docker. With \docks they can deploy pre-configured applications and
develop an understanding of the features provided by \docker using the 
web user interface. It is assumed these users know the basic \docker
terminology and can learn from the \docker documentation.

\subsection{Subsystems}
\docks consists of two projects with distinct purposes:
\docks UI which is the web user interface running in the web browser
and \docks API which is the server running on a Manager Node*.

\docks UI is responsible for displaying information about applications running
in \docker, and to provide a convenient interface for sending information
to \docker via the \docks API.

\docks API is responsible for providing authenticated access to the \docker API.
It also extends the \docker API by providing the ability to deploy Stacks*
and monitor \docker events for sending notifications.

Across these two projects exist a number of subsystems

\subsubsection{Authentication}
The authentication subsystem is responsible for authenticating
and authorizing users as well as managing (create, edit, delete) user accounts.

\subsubsection{Webhooks and Docker Events}
This subsystem is responsible for managing (create, edit, delete) webhooks.
It interfaces with the Docker API to listen for events and send relevant
date to the stored webhooks. The

The Docks system consists of two main subsystems. The Docks API Server and the Docks UI.

\begin{itemize}
	\item All management and view operations require authentication and the correct authorization
	\item Fine-grain permission control for user accounts
	\item Account roles with different permissions
	\item View Docker Nodes that are part of the Swarm
	\item View Services that are running in the Swarm
	\item View Tasks running in the Swarm
	\item Start and stop services
	\item Remove services
	\item Deploy a Stack to the Swarm using a docker-compose file
	\item Deploy a Service to the Swarm
	\item View Networks in the Swarm
	\item View Volumes in the Swarm
	\item Deploy images from a private repository
\end{itemize}

\subsubsection{Docks API Server}
The Docks API Server acts as a middleman between the UI and the Docker API
running on the Manager Node. The Docks API also adds a layer of authentication
and session management over the Docker API.

\subsubsection{Docks UI}
Docks UI is the web interface for managing the Docker Swarm through the Docks API. 
It consumes the API provided by the Docks API server.

\subsection{Specific Requirements}

\begin{itemize}
	\item R1.1 The system shall allow an authorized user to interact with the Docks API
	\item R1.2 The system shall allow a user to perform actions only when they are authorized to do so.
	\item R1.3 The system shall provide a global administrative account role without restrictions
	\item R1.4 The system shall provide Teams
	\item R1.5 The system shall provide the ability to add Users to Teams
	\item R1.6 The system shall only allow a User to manage resources that are part of their team.
	\item R1.7 The system shall provide the following account roles within Teams: (Role (Permissions))
	      \begin{itemize}
		      \item R1.7.1 Team Leader
		      \item R1.7.2 Super User
		      \item R1.7.3 Normal User
		      \item R1.7.4 Guest
	      \end{itemize}
	\item R1.8 Roles shall have the following permissions:
	      \begin{itemize}
		      \item R1.8.1 Team Leader
		            \begin{itemize}
			            \item Add users to team
			            \item Bind Mount
			            \item Deploy Resources
		            \end{itemize}
		      \item R1.8.2 Super User
		            \begin{itemize}
			            \item Bind Mount
			            \item Deploy Resources
		            \end{itemize}
		      \item R1.8.3 Normal User
		            \begin{itemize}
			            \item Deploy Resources
		            \end{itemize}
		      \item R1.8.4 Guest
		            \begin{itemize}
			            \item Read only access. No access to Inspect
		            \end{itemize}
	      \end{itemize}
	\item R1.9 The system shall provide the following user management features to be used by administrative accounts
	      \begin{itemize}
		      \item R1.9.1 Create new user
		      \item R1.9.2 Remove user
		      \item R1.9.3 Update user password
		      \item R1.9.4 Set permissions as stated in R1.3
	      \end{itemize}
\end{itemize}

\subsubsection{Docker Swarm Management Functions}
\begin{itemize}
	\item R2.1 The system shall display all nodes in the swarm.
	\item R2.2 The system shall display all services running in the swarm.
	\item R2.3 The system shall display the following attributes about a Task:
	      \begin{itemize}
		      \item R2.3.1 Container Name (if set)
		      \item R2.3.2 Uptime
		      \item R2.3.3 Container ID
		      \item R2.3.4 State of the container (running/stopped)
		      \item R2.3.5 Image used to create the task
	      \end{itemize}
	\item R2.4 The system shall allow a user to stop a running service
	\item R2.5 The system shall allow a user to start a stopped service
	\item R2.6 The system shall allow a user to upload a docker-compose file to deploy a Stack
	\item R2.7 The system shall allow a user to remove a stopped service
	\item R2.8 The system shall allow a user to destroy a Stack
	\item R2.9 The system shall display the networks on a Node
	\item R2.10 The system shall display the volumes on a Node
	\item R2.11 The system shall be able to deploy images from a private repository
	\item R2.12 The system shall display the following attributes about a Service
	      \begin{itemize}
		      \item R2.12.1 Service Name
		      \item R2.12.2 Stack (if deployed from Stack)
		      \item R2.12.3 Tasks running in the service
		      \item R2.12.4 State of the Service
		      \item R2.12.5 Image used to create the Service
	      \end{itemize}
\end{itemize}

\section{Architecture}
\subsection{Interfaces}
\subsubsection{Software Interfaces}
Since the frontend cannot securely interface with the Docker API,
an intermediate interface will be developed (Docks API).
The Docks API will communicate between the frontend (Docks-UI) and
the Docker API. The Docks API will provide a simplified interface for
interacting with the Docker API.


\subsection{System Configuration}
The Deployment diagram shows the architecture from the device perspective.

\begin{figure}[H]
	\centering
	\includegraphics[scale=0.5]{deployment-diagram.png}
	\caption{UML Deployment Diagram for the Docks System}
\end{figure}

\subsection{ERD Diagram}
The Deployment diagram shows the database architecture for the Docks API system

\begin{figure}[H]
	\centering
	\includegraphics[scale=0.5]{erd.png}
	\caption{ERD diagram for the Docks API database}
\end{figure}

\subsection{Architectural Styles}
% TODO: Clarify this section
The User Interface uses the Model View Controller architecture.
Nodes and Containers have a data model.
The user interacts with the view to manipulate the data model.
The view is updated when the data model retrieves data using an N-Tier architecture.
The 3-Tier architecture can be seen by the actor interacting with the view,
the request is then delegated to the models, which in turn
communicate with other objects to retrieve and set the required data from
the Docker API server and Docker Swarm.

\begin{figure}[h]
	\centering
	\includegraphics[scale=0.4]{architecture-diagram.png}
	\caption{MVC and 3-Tier Architecture diagram for the Docks system}
\end{figure}


\end{document}
